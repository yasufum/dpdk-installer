---
# Deploys the whole application stack in this site.

- name: apply all base packages
  hosts: all
  remote_user: "{{ user_account }}" 
  roles:
    - common
  environment:
    http_proxy: "{{ http_proxy }}"
    https_proxy: "{{ http_proxy }}"

- name: install dpdk
  hosts: dpdk 
  remote_user: "{{ user_account }}" 
  roles:
    - dpdk 
  environment:
    http_proxy: "{{ http_proxy }}"
    https_proxy: "{{ http_proxy }}"

- name: install kvm 
  hosts: dpdk 
  remote_user: "{{ user_account }}"
  roles:
    - kvm
  environment:
    http_proxy: "{{ http_proxy }}"
    https_proxy: "{{ http_proxy }}"

- name: install spp and qemu 
  hosts: spp
  remote_user: dpdk
  roles:
    - spp
  environment:
    http_proxy: "{{ http_proxy }}"
    https_proxy: "{{ http_proxy }}"

- name: install pktgen
  hosts: pktgen 
  remote_user: "{{ user_account }}"
  roles:
    - pktgen
  environment:
    http_proxy: "{{ http_proxy }}"
    https_proxy: "{{ http_proxy }}"
